
------ Get Difference between date time
declare
strTime1 varchar2(50) := '02/08/2013 01:09:42 PM';
strTime2 varchar2(50) := '02/08/2013 11:09:00 PM';
v_date1 date := to_date(strTime1,'DD/MM/YYYY HH:MI:SS PM');
v_date2 date := to_date(strTime2,'DD/MM/YYYY HH:MI:SS PM');
difrence_In_Hours number;
difrence_In_minutes number;
difrence_In_seconds number;
begin
    difrence_In_Hours   := (v_date2 - v_date1) * 24;
    difrence_In_minutes := difrence_In_Hours * 60;
    difrence_In_seconds := difrence_In_minutes * 60;

    dbms_output.put_line(strTime1);        
    dbms_output.put_line(strTime2);
    dbms_output.put_line('*******');
    dbms_output.put_line('difrence_In_Hours  : ' || difrence_In_Hours);
    dbms_output.put_line('difrence_In_minutes: ' || difrence_In_minutes);
    dbms_output.put_line('difrence_In_seconds: ' || difrence_In_seconds);        
end ;


-- LOgics

-- COUNT all orders that successfully delivered!

SELECT COUNT(*) Number_Of_Orders_Delivered
FROM(
    SELECT orderId, orderDate, status
    FROM ORDERS
    WHERE status = 'Delivered');

-- Percentages of the orders that have successfuly delivered


SELECT COUNT(*) Number_Of_Orders_Delivered
FROM(
    SELECT orderId, orderDate, status
    FROM ORDERS
    WHERE status = 'Delivered');